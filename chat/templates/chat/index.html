<!-- chat/templates/chat/index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Enter a Chat Room</title>
  <!-- âœ… Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- âœ… Flowbite CSS -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.3.0/flowbite.min.css" rel="stylesheet" />
</head>
<body class="bg-gray-100 text-gray-800 min-h-screen flex items-center justify-center">
  <div class="w-full max-w-2xl bg-white p-8 rounded-xl shadow-lg">
    <h1 class="text-3xl font-bold text-center text-blue-600 mb-6">ðŸ’¬ Secret Chat Room</h1>

    {% if user.is_authenticated %}
      <h2 class="text-xl text-center mb-6">Welcome, <span class="font-semibold">{{ user.username }}</span>!</h2>

      <!-- Room entry form -->
      <form id="room-form" onsubmit="event.preventDefault(); enterRoom();" class="flex gap-2 mb-6">
        <input id="room-name-input" type="text" placeholder="Room name" required autocomplete="off"
               class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none" />
        <button type="submit"
                class="px-5 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition">
          Enter
        </button>
      </form>

      <!-- Active rooms list -->
      <h3 class="text-lg font-semibold mb-2">Active Rooms:</h3>
      <ul class="space-y-2 mb-6">
        {% for room in active_rooms %}
          <li>
            <a href="{% url 'room' room.room %}"
               class="block p-3 bg-gray-50 hover:bg-blue-50 border border-gray-200 rounded-lg transition">
              <span class="font-medium text-blue-700">{{ room.room }}</span>
              <span class="text-sm text-gray-500">({{ room.message_count }} messages)</span>
            </a>
          </li>
        {% empty %}
          <li class="text-gray-500">No active rooms yet. Start the conversation!</li>
        {% endfor %}
      </ul>

      <!-- Logout button -->
      <form method="post" action="{% url 'logout' %}" class="text-center">
        {% csrf_token %}
        <button type="submit"
                class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition">
          Logout
        </button>
      </form>

      <!-- JS -->
      <script>
        function enterRoom() {
          const roomName = encodeURIComponent(document.getElementById('room-name-input').value);
          window.location.href = `/chat/${roomName}/`;
        }
      </script>

    {% else %}
      <h2 class="text-center text-lg mb-6">
        Please <a href="{% url 'login' %}" class="text-blue-600 underline">log in</a>
        or <a href="{% url 'signup' %}" class="text-blue-600 underline">sign up</a> to chat.
      </h2>
    {% endif %}
  </div>
</body>
</html>
